# python和anaconda

这节课我们会介绍python和anaconda。和其他python编程网课不同，这里我们只用一节课大约30分钟的时间来讲python，便足够我们接下里的课程使用了。

在正式内容以前，为了打消大家的顾虑，这里先给大家树立一个理念。这个理念也许只在少数情况适用，甚至也许只在这个系列的网课适用，但是却很能说明，为什么这门课这门这么短，却这么有用。请大家悉知：python本身是一个工具箱，里面有很多对于工程师来说十分便利的工具和原料，但是这仅限于工程师。而我们要学习的不是如何用这些工具去创造，而是如何使用这些用python创造出来的完成品。就像学开车不需要了解每个零件是做什么的，只要跟着教程，每个人都能学会开车。

上完这门课，你会学到的内容有：

* python和anaconda的安装
* 在powershell或terminal上运行python
* 库（package）的概念
* 在powershell或terminal上用pip命令安装库（需要结合lesson13的内容）
* 如何运行一段别人写的代码

上完这节课，结合前面课程的一些理论知识，基本就能独立的寻找，并使用一些简单的代码项目解决工作中遇到的一些问题了。但是不要急，到这里为止，要大家独立解决问题可能花费的时间成本和精力成本还是太高了，我们会在接下来的课程做进一步的知识补充以及更重要的实例补充，带着大家一步一步熟悉和熟练整个流程。

成功安装后我们可以来到第二部分的内容，初试python，在powershell或terminal中运行一个python程序。

## 首先是python和anaconda的安装

虽然有点水内容的嫌疑，但是这部分的内容还是必须的。首先简单介绍一下python和anaconda的区别，简单的理解，python是最原生最干净的工具箱，官方提供了什么就有什么，别的一概没有，可以理解为裸车，或者毛坯房。而anaconda是已经帮你装好很多常用“库”的python，可以理解为加了很多常用配件的车，比如高级音响，座位加热，玻璃贴膜等，类比房子则是拎包入住的样品房。这里要注意的有两点，一是，anaconda也是python，二是库的概念，我们会在这门课讲到，也是这节课的重点。

python和anaconda大家选一个装就好了，python装下来占用的磁盘更小，anaconda因为带了很多库，因此会比较大，接近2个GB。但是就以后的实验方便考虑，可以少装很多库，建议大家安装anaconda。这里我们选择python 3.6.5对应的版本，这里要注意的是，不同的代码会有不同的python版本要求，这部分内容不在课程的内容中，但是如果各位学员以后遇到版本相关的问题，可以直接微信咨询我或者我们的后台程序员小哥。

python和anaconda的安装这里大家一步一步跟着我做就好了，很简答。我们首先介绍python的安装，然后介绍anaconda。下面流程的动图都会以windows作为系统，对于OSX即苹果系统或者Linux系统，主要是将powershell换成terminal，并在环境配置时操作不同，对应步骤都会有分开的说明。为了缩减文字部分的篇幅，请大家一定要结合课程文本内容中的动图和课程最后的资料进行学习。比如下面的python和anaconda安装说明，用文字描述很麻烦，几百字不如一张动图来的更直观。

1. 从[python官网](https://www.python.org/downloads/)的下载页面下载对应系统python的安装包。
2. 安装python，注意记下python的安装目录，不要无脑下一步了，另外务必注意动图中的安装选项选择。主要是一些python运行路径的自动设置等。由于我们安装的是3.6.5，python安装包中自带了pip工具，安装时也请注意勾选。
3. 重启电脑并验证python和pip是否安装成功，这里只需要在powershell中输入python --version和pip --version，如果真确出现了对应的版本号信息，则说明安装成更了。这里需要补充的是，因为有些电脑系统会默认安装一个python给系统用，有时候会出现冲突，如果发现安装的python3.6.5，打印出来的确是python 2.x的版本信息，此时可以试一试python3 --version。如果还是不行，大概率是**安装时没有正确勾选环境变量设置的选项**，大家可以从新跟着上面的动图，一步，一步的安装，从新安装一遍即可。
4. 如果在安装python时没有安装pip，则需要额外安装pip工具，这里清仔细阅读[这篇博客](https://zhuanlan.zhihu.com/p/38603105)进行安装和配置，关于**环境变量是什么以及环境变量娘设置**，可以本节内容后面的补充内容。

接下来是anaconda的安装教程。

1. 在[csdn的这篇博客](https://blog.csdn.net/yuejisuo1948/article/details/81043823)中找到python 3.6.5对应的anaconda版本。
2. 从[anaconda官网](https://repo.anaconda.com/archive/)的下载页面下载对应python版本的安装包。
3. 安装anaconda，注意记下anaconda的安装目录，不要无脑下一步，另外务必注意动图中的安装选项选择。
4. 重启并验证anaconda是否安装成功

动图中我尽量详细的展示了安装步骤，如果还有其他疑问，大家可以上知乎搜索python和anaconda的安装教程作为补充，注意强调安装的版本，一定要是python3.6对应的版本。或者可以加我和后台程序员小哥的微信询问，我们会尽快回答你的问题。

## 运行python以及运行一个python程序

这一部分内容我们分两个部分，第一部分是直接在powershell中输入python的语句运行，第二部分是运行别人写的一段python代码段。学习完这部分的内容，对于一些简单的问题和需求，我们便可以直接从网上找别人写好的代码，尝试解决。当然，其中可能会涉及到少量的代码修改，比如路径的修改，需要结合第一部分lesson 9的课程内容，我们会把这种稍复杂的内容放在后面的实例中。

运行几句python代码找找感觉，我们要做两个小任务，第一个任务是计算123.45乘以543.21的结果，第二个任务是创建一个文件叫hundred.txt，并在里面输入从0到99一共100个数字，每个数字一行：

1. 打开powershell，输入python3，按回车。这一步是在powershell中运行“python”这个程序，在上节课提到相关内容。
2. 输入a = 123.45 回车
3. 输入b = 543.21 回车
4. 输入c = a * b 回车
5. 输入print(c)
6. 这里大家会发现在powershell中显示出了123.45乘以543.21的结果，大家可以用计算器验证一下
7. 另外，直接输入123.45 * 543.21 回车，也能得到一样的结果
8. 接下来是第二个稍复杂的任务，创建一个文件，写入0到99，一行一个数字
9. 输入file = open('hundrad.txt','w') 回车。这时你会发现在当前文件夹下出现了一个hundrad.txt文件
10. 输入for i in range(100): a = file.write(str(i)+"\n") 回车
11. 输入file.close() 回车
12.  此时打开hundrad.txt文件，你会发现文件中已经写入了0-99共100个数字
13. 输入exit() 回车，退出python

刚刚我们通过直接输入python的代码，完成了两个小任务，这些代码其实就是python这个大工具箱给我们的工具。那么如何使用别人写好的一大段代码来完成一个更加复杂的任务呢？比如现在有一个这样的问题：比如在当前目录有一个work文件夹，文件夹里有1000个zip压缩文件，即xxx.zip文件，现在要**批量的解压所有的zip文件**。步骤分为几个：

1. 用lesson 12中的方法在网上找到[代码](https://www.pythonf.cn/read/139457)
2. 用pip或conda安装（可能需要的额外）库，这库会在下一节说明，这里大家跟着教程做接好，暂时不需要理解。
3. 创建一个后缀为.py的文件，比如unzip.py，这里可以先创建一个txt记事本文件，然后修改后缀为py
4. 将网上找到的代码复制到这个文件内，保存
5. 打开powershell，运行python3 unzip.py ./work

上面几步的关键步骤是第一步，找到代码，第三步，创建py文件并复制粘贴代码，以及第五步用python运行这段代码。

## 库（package）是什么

库，或者包，就是一个程序中用到的已经打包好的工具。和我们一样，程序员在写代码的时候，为了方便，也会使用别人已经写好的，但是使用这些工具的前提是下载并且安装它们。同样的，我们为了使用这些代码，也需要在自己的电脑上安装这些工具。

实际上，在上一节中，我们找到并运行的解压文件代码，也用到了库，这个库就是unzip。幸运的是，这个库已经被纳入python这门语言的官方自带的库中，也就是属于python语言的一部分了，当安装python的时候，也会自动的将所有的官方库安装到电脑上，因此可以直接使用，无需额外的安装了，我们称这些库为官方库，或者叫标准库。多说一句，标准库是一个普适的概念，对于不同的语言（除了python以外，比如还有C语言，C++，JAVA等计算机语言），都有自己的标准库，实现了不同的功能。

我们在这节课的第一部分讲过，anaconda其实就是python，两者对于我们来说最大的区别就是，ananconda为我们安装了很多额外的，常用的，非官方自带的库，因此对很多代码比较友好，可以直接贴过来就能运行，不需要额外的库安装步骤了。

另外一个很重要的问题是，我要用的代码或者程序，需要哪些库呢？这里可以从四个地方知道。

1. 源代码中。我们还是看上面代码的例子unzip.py。每一段python代码前，基本上都会有几行以import 开头的代码，比如常见的有import os，import sys。或者像unzip.py中的import zipfile，这里import是一个关键词，意思是“引入”，即我要“引用叫zipfile的这个库了”。因此，这段代码可能会用到zipfile这个工具，如果电脑里没有，就需要安装了。

2. readme中。首先，readme可以理解为是一个程序的说明书，他其实也是一个文件。在哦第12课的时候，我们介绍了github。我们可以打开在github中的某一个项目，比如下面[这个](https://github.com/YexingWan/Fast-Portrait-Segmentation)(这个人像小程序是玩老师空余时间做的，仅作为玩具^v^，各位学员也可以顺路star一下~)。可以直接在网页中看到，这个项目的说明，这里说明是英文的，标题为Fast Portrait Segmentation，后面有如何安装这个程序，**这个程序的依赖项有哪些**，以及如何运行这个程序等等信息。这里的“依赖项”指的就是这个程序需要外安装哪些库

3. requirement.txt中。对于完善的python项目，一般会有一个文件名为requirement.txt的文件，里面会记录着所有需要额外安装的库的名字和版本信息。比如还是刚刚的项目，点开**pyFaceSeg**文件夹，我可以看到一个叫requirement.txt的文件，点看这个文件，可以看到，每行就是一个库的名字和他的版本号的要求。

4. 当然，也会存在个别的项目并没有自带requirements文件，然后readme中也并未做详细说明，这种情况可能就会需要直接去运行程序，看下终端中是否会出现缺失某个库的信息。

   Ps: 补充找不到库的报错信息图片，承接下面安装内容

知道了库是什么，以及哪里知道需要安装哪些库以后，我们来到下一个部分的内容，如何安装这些库。

## 用pip安装python的库

这部分内容我们来讲如何安装库。注意，接下来讲的都是python的库的安装，下面的内容里出现的“库”，都是指python的库。

库的安装也许不像我们常见的安装一个程序那么直观，但是很幸运的是，安装python的库相对与其他语言来说，显得格外简单。还是以上面我自己写的小程序为例子说明。首先介绍一下用来安装库的重磅软件，pip。

我们在第13课中介绍了powershell和terminal可以用来运行那些没有界面的软件。而python就是这样一个“软件”，pip也是这样一个软件。在本节课安装python的部分，我们强调了pip的安装，这个时候我们直接用就好了。

### 重要的步骤

因为用pip安装库的过程中涉及到下载文件，由于墙的原因，安装某些库会异常的慢，这里我们需要多一步设置。这个设置只需要做一次即可，可以让你的pip装库流程如丝般顺滑：

1. 随便打开一个文件夹，在路径处输入%appdata% 回车。此时将会进入到一个文件夹内，如下图

2. 右键空白处，创建一个文件夹，名字命名为pip

3. 进到这个pip文件夹内，创建一个文本文件，命名为pip.ini【注意，这里需要修改文件后缀，在windows系统中需要设置文件显示后缀，在动图中包括如何设置的操作，这里请各位学员参照动图设置，不在赘述】

4. 用记事本打开pip.ini文件，将下面这段文字复制进去并保存：

   [global] timeout = 6000

   index-url = https://pypi.tuna.tsinghua.edu.cn/simple

   trusted-host = pypi.tuna.tsinghua.edu.cn

这样，pip就设置好了。接下来，我们来收如何用pip安装python包。

用pip安装python包的方式常用的有两种：

1. 直接通过包的名字安装，以刚刚提供的Fast Portrait Segmentation项目为例，我们看到requirement.txt中有一行numpy==1.18.4，也就是说这个项目的其中一个依赖包名字是numpy，版本为1.18.4。此时我们可以通过**命令行的方式安装版本为1.18.4的numpy包**。流程如下

   * 打开powershell（或terminal）
   * 输入 pip install numpy==1.18.4 回车确认

   此时可以看到在powershell中会打印许多信息，这个命令行的意思是，运行pip，用pip 安装（install）numpy，并设定numpy的版本为1.18.4。当程序执行完毕后，numpy便安装好了。

   不要叉掉powershell，接下来的一步是检查numpy是否安装成功:

   * 输入python 回车，运行python，进入到python的命令界面
   * 与之前看到的一些代码一样，输入import numpy 回车，将numpy导入到当前的代码中
   * 此时如果没有出现错误，基本说明numpy已经安装成功了，输入numpy.\__version__，会看到出现一条‘1.18.4’的文字，说明numpy安装正确。

2. 我们学会了第一种用pip安装单独一个包的方法，现在我们来学更加方便的第二种，用pip安装大一堆包。众所周知，程序员是一个很懒的物种，他们非常怕麻烦，因此会开发一些列工具来简化流程。第二种方法也是用pip，除此之外还需要一个文件，就是我们一直提到的，requirement.txt。

   一个比较完整的python项目一般都会提供一个requirement.txt文件，里面记载着所需要安装的包。如果我们想安装里面的所有的包，此时只需要三步，是的，之比安装单独一个包多一步。我们还是拿Fast Portrait Segmentation项目为例，上文提到这个项目中又一个requirement.txt文件。

   * 打开powershell（或terminal）

   * 将“当前工作目录”设定到requirement.txt所在的目录下，这一步操作在第十三课中有重点提到，我们是用cd这个软件。假如，requirement.txt这个文件在C:/user/wanwan/files这个路径下，即requirement.txt的完整路径为C:/user/wanwan/files/requirement.txt，那么我们首先将“当前工作路径”设置为C:/user/wanwan/files/

     用到的命令为 **cd C:/user/wanwan/files/ **回车【注意，如果是想要安装Fast Portrait Segmentation中requirement.txt中列举的包，同样的，也需要用cd定位到对应的目录下】

     cd这个软件很重要，也非常简单，如果大家不熟悉可以回第十三课复习一下

   * 第三步，用pip安装requirement.txt中的所有包，我们用到的命令为

     **pip install -r requirement.txt** 回车

   然后等待程序运行完成，这里最后一个命令便是运行pip，安装，从requirement.txt中读取到的所有包的名称和版本

自此，我们便学会了如何通过pip安装python的库了。



## 实例Fast Portrait Segmentation

第十四节课的最后，我来带大家将Fast Portrait Segmentation这个小项目跑起来。首先，我们需要一个连接摄像头的电脑，比如笔记本就很好。

第一步当然是将代码下载下来并解压。这一步的具体操作如果大家忘记了，可以参考第十二课的内容，有详细的如何在github上下载代码的流程。

将代码下载好，并在确认python和pip正确安装以后，为了将这个“人脸分割”的有趣小项目跑起来，我们需要知道应该安装哪些库。根据上面的教程，我们可以在项目的pyFaceSeg文件夹中中需要找到一个requirements.txt的文件。此时我们要做的就是用上一节介绍的pip安装库。定位并进入到pyFaceSeg文件夹，然后用本节课上一节内容介绍的pip安装库。

```
pip install -r requirements
```

安装完库以后，理论上我们已经可以运行这个项目了，那应该怎么运行呢？我们回到项目github的网站，看到下面有一篇这个项目的介绍.......哦天啊竟然是英文的。这里大家不必担心，首先我们有优秀的在线翻译软件，更重要的是，在第十六课，我会一步一步的教大家如何看懂这些github上佶屈聱牙的说明，或者说，如何抓其中的重点阅读和了解。只要学会如何读项目说明书，根据说明书安装和准备，便能顺利的使用个项目代码了（在大部分情况下）

这里我们以最快速度扫一遍说明，诶？是不是有很熟悉的运行命令：

```
python cam_seg.py 
```

是的，就像运行解压代码段一样，我们只需要在powershell中运行上面这个命令。这个命令的意思是让你的电脑：硬python运行com_seg.py这个文件中的python代码。

如果一切准备妥当，代码将会顺利运行，此时你的电脑摄像头将会被打开，然后弹出一个软件框，你会看到你的人像被分割了出来，背景被替换成了在同一个文件夹下的test.png图片。当然，你也可以替换test.png，比如用一张你喜欢的背景图片，改名为test.png，然后拖到代码所在文件夹，并运行这个项目。

自此为止，我们执行了第一个，别人（是的就是你们的玩老师）写好的，并上传到在github上的，拥有复杂功能（说实话实现起来确实挺复杂的）的项目了。（撒花）

下一节课，是一门较为进阶的课程，在一些复杂的项目上可能会用到，我们会介绍一个程序员常用来简化代码设置的方法：各类常用的配置文件。程序员会将一些重要的，灵活的可变配置，放到一个特定格式的文本文件中，方便管理和修改。对于下一节课的内容，大家可以作为选读，等碰到了在回头看，但是还是建议大家先看一个大概，了解配置文件的概念，避免碰到了都不知道自己碰到了的情况。

大家可以在略读完下一课以后，直接跳到第十六课，第十六课的内容可能更加需要大家掌握，即，如何看懂github上的项目说明书，Readme。

那这节课先到这里，下课！！！！

## 补充内容：环境变量是什么

这里补充一个概念，叫环境变量。介绍两点，什么是环境变量，以及怎么设置环境变量。

首先什么是环境变量。大家对变量的概念应该不陌生，在第四节课的内容涉及到，而环境变量其实就是一个“字符串”类型的数据，环境变量是程序员和系统约定好变量名的，有特殊功能的字符串，系统会直接访问这些环境变量获取对应的值，比如一个路径。举个栗子，python和系统之间有个约定俗成环境变量，名称是PYTHONPATH，如果系统发现你设置了这个环境变量，就会优先从这个变量中找你安装的python库。此外还有一个很重要的环境变量PATH，我们通过powershell输入的命令，比如，python cam_seg.py，系统会优先从这个环境变量中的路径找匹配的软件“python.exe”，然后运行。如果在搜索了所有路径发现都没有一个可以执行的叫python的软件，那么powershell就会告诉你，我找不到叫python的软件，运行不了，你看着办。所以电脑其实是个很蠢的东西，啥都要让你告诉他，他才会动。

第二点，windows10有哪些环境变量呢？如何设置环境变量呢？这里会以windows10系统为例做一个动态图展示如何找到以及设置环境变量，另外大家可以参考[这篇博客](https://blog.csdn.net/yeyueqin/article/details/92801051)